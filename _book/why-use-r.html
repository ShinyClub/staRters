<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Why use R? | staRters; An introductory workshop for analysis of data with R</title>
  <meta name="description" content="HU Ontwikkelfestival, 2-4 November, 2020" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Why use R? | staRters; An introductory workshop for analysis of data with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="HU Ontwikkelfestival, 2-4 November, 2020" />
  <meta name="github-repo" content="uashogeschoolutrecht/staRters" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Why use R? | staRters; An introductory workshop for analysis of data with R" />
  
  <meta name="twitter:description" content="HU Ontwikkelfestival, 2-4 November, 2020" />
  

<meta name="author" content="Marc A.T. Teunis, PhD" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="gettingstarted.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/d3-5.7.0/d3.min.js"></script>
<script src="libs/d3-lasso-0.0.5/d3-lasso.min.js"></script>
<link href="libs/ggiraphjs-0.3.0/ggiraphjs.min.css" rel="stylesheet" />
<script src="libs/ggiraphjs-0.3.0/ggiraphjs.min.js"></script>
<script src="libs/girafe-binding-0.7.8/girafe.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis with R for staRters</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="why-use-r.html"><a href="why-use-r.html"><i class="fa fa-check"></i><b>2</b> Why use R?</a></li>
<li class="chapter" data-level="3" data-path="gettingstarted.html"><a href="gettingstarted.html"><i class="fa fa-check"></i><b>3</b> Getting Started</a></li>
<li class="chapter" data-level="4" data-path="edacase.html"><a href="edacase.html"><i class="fa fa-check"></i><b>4</b> Case Example</a></li>
<li class="chapter" data-level="5" data-path="introrstudio.html"><a href="introrstudio.html"><i class="fa fa-check"></i><b>5</b> Introduction to RStudio</a></li>
<li class="chapter" data-level="6" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>6</b> Literate Programming with RMarkdown</a></li>
<li class="chapter" data-level="7" data-path="intror.html"><a href="intror.html"><i class="fa fa-check"></i><b>7</b> Introduction to R</a></li>
<li class="chapter" data-level="8" data-path="recursivevectors.html"><a href="recursivevectors.html"><i class="fa fa-check"></i><b>8</b> Lists and dataframes</a></li>
<li class="chapter" data-level="9" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>9</b> Visualize &amp; Explore Data</a></li>
<li class="chapter" data-level="10" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>10</b> Data Wrangling</a></li>
<li class="chapter" data-level="11" data-path="tidydata.html"><a href="tidydata.html"><i class="fa fa-check"></i><b>11</b> Tidy Data</a></li>
<li class="chapter" data-level="12" data-path="importingdata.html"><a href="importingdata.html"><i class="fa fa-check"></i><b>12</b> Importing data</a></li>
<li class="chapter" data-level="13" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>13</b> Assumptions and statistical models</a></li>
<li class="chapter" data-level="14" data-path="sampling-bootstrapping.html"><a href="sampling-bootstrapping.html"><i class="fa fa-check"></i><b>14</b> Sampling, Probability distributions and bootstrapping</a></li>
<li class="chapter" data-level="15" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>15</b> Resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/uashogeschoolutrecht/staRters" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">staRters; An introductory workshop for analysis of data with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="why-use-r" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Why use R?</h1>
<div id="packages" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Packages</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="why-use-r.html#cb9-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb9-2"><a href="why-use-r.html#cb9-2"></a><span class="kw">library</span>(nlme)</span></code></pre></div>
</div>
<div id="course-contents-materials" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Course contents &amp; materials</h2>
<p style="font-size:18px">
<p>The complete source code for the webinars and all dependent data, and files can be found on <a href="https://github.com/uashogeschoolutrecht/staRters">Github.com/uashogeschoolutrecht/staRters</a>.</p>
<ul>
<li>Day 1: Why R, Case demo, RMarkdown, Intro R syntax</li>
<li>Day 2: Visualization, Data Wrangling, Tidy data</li>
<li>Day 3: Data import, Statistics (assumptions &amp; regression)</li>
</ul>
<p><em>Disclaimer: “This is not a course on statistics”. If you have a specific statistical challenge and you would like to discuss this after the course with me, feel invited to reach out!</em></p>
</div>
<div id="introducing-reproducible-open-science" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Introducing Reproducible (Open) Science</h2>
<ol style="list-style-type: decimal">
<li>When things go wrong</li>
<li>Why Reproducible (Open) Science?</li>
<li>The need for learning programming</li>
<li>An example of Reproducible (Open) Science</li>
</ol>
<p><span class="math inline">\(Reproducible\ (Open)\ Science =\)</span>
<span class="math inline">\(Reproducible\ Research + Open\ Science\)</span></p>
</div>
<div id="data-methods-and-logic" class="section level2 build" number="2.4">
<h2><span class="header-section-number">2.4</span> Data, methods and logic</h2>
<p><em><a href="https://doi.org/10.1073/pnas.1708279115">Brown, Kaiser &amp; Allison, PNAS, 2018</a></em></p>
<p>"…in science, three things matter:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>the data,</li>
<li>the methods used to collect the data […], and</li>
<li><strong>the logic connecting the data and methods to conclusions,</strong></li>
</ol>
</blockquote>
<p>everything else is a distraction."</p>
</div>
<div id="gollums-lurking-about" class="section level2 build" number="2.5">
<h2><span class="header-section-number">2.5</span> <code>Gollums</code> lurking about</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="why-use-r.html#cb10-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(</span>
<span id="cb10-2"><a href="why-use-r.html#cb10-2"></a>  here<span class="op">::</span><span class="kw">here</span>(</span>
<span id="cb10-3"><a href="why-use-r.html#cb10-3"></a>    <span class="st">&quot;images&quot;</span>,</span>
<span id="cb10-4"><a href="why-use-r.html#cb10-4"></a>    <span class="st">&quot;gollum_climbing.jpg&quot;</span></span>
<span id="cb10-5"><a href="why-use-r.html#cb10-5"></a>  )</span>
<span id="cb10-6"><a href="why-use-r.html#cb10-6"></a>)</span></code></pre></div>
<p><img src="images/gollum_climbing.jpg" width="145" /></p>
<p>“In one case, a group accidentally used reverse-coded variables, making their conclusions the opposite of what the data supported.”</p>
<p>“In another case, authors received an incomplete dataset because entire categories of data were missed; when corrected, the qualitative conclusions did not change, but the quantitative conclusions changed by a factor of &gt;7”</p>
<p style="font-size:14px">
<a href="https://doi.org/10.1073/pnas.1708279115">Brown, Kaiser &amp; Allison, 2018; PNAS</a>
</p>
</div>
<div id="why-we-need-reproducible-open-science" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Why we need Reproducible (Open) Science?</h2>
<blockquote>
<ul>
<li>To assess validity of science and methods we need access to data, methods and conclusions</li>
<li>To learn from choices other researchers made</li>
<li>To learn from omissions, mistakes or errors</li>
<li>To prevent publication bias (also negative results will be available in reproducible research)</li>
<li>To be able to re-use and/or synthesize data (from many and diverse sources)</li>
<li>To have access to it all!</li>
</ul>
</blockquote>
<p style="font-size:14px">
<a href="https://www.nature.com/collections/prbfkwmwvz">Nature Collection on this topic</a>
</p>
</div>
<div id="the-gui-problem" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> The <em>GUI problem</em></h2>
<p>How would you ‘describe’ the steps of an analysis or creation of a graph when you use <em>GUI</em> based software?</p>
<p><em><em>“You can only do this using code, so it is (basically) impossible in a GUI”</em></em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="why-use-r.html#cb11-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(</span>
<span id="cb11-2"><a href="why-use-r.html#cb11-2"></a>  here<span class="op">::</span><span class="kw">here</span>(</span>
<span id="cb11-3"><a href="why-use-r.html#cb11-3"></a>    <span class="st">&quot;images&quot;</span>,</span>
<span id="cb11-4"><a href="why-use-r.html#cb11-4"></a>    <span class="st">&quot;messy_steps.jpg&quot;</span></span>
<span id="cb11-5"><a href="why-use-r.html#cb11-5"></a>  )</span>
<span id="cb11-6"><a href="why-use-r.html#cb11-6"></a>)</span></code></pre></div>
<p><img src="images/messy_steps.jpg" width="758" /></p>
<p style="font-size:14px">
*<a href="https://en.wikipedia.org/wiki/Graphical_user_interface">Graphical User Interface (GUI)…is a form of user interface that allows users to interact with electronic devices through graphical icons and audio indicator such as primary notation, instead of text-based user interfaces, typed command labels or text navigation…</a>
</p>
</div>
<div id="programming-is-essential-for-reproducible-open-science" class="section level2 build" number="2.8">
<h2><span class="header-section-number">2.8</span> Programming is essential for Reproducible (Open) Science</h2>
<blockquote>
<ul>
<li>Only programming an analysis (or creation of a graph) records every step</li>
<li>The script(s) function as a (data) analysis journal</li>
<li>Code is the logic that connects the data and methods to conclusions</li>
<li>Learning to use a programming language takes time but pays of at the long run (for all of science)</li>
</ul>
</blockquote>
</div>
<div id="introducing-literate-programming" class="section level2" number="2.9">
<h2><span class="header-section-number">2.9</span> Introducing Literate programming</h2>
<ul>
<li>Literate) programming is a way to connect narratives to data, methods and results</li>
<li>All scripts in this course are <strong>R Markdown</strong> scripts</li>
<li>The complete source of the reader is available in Github.com</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="why-use-r.html#cb12-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;images&quot;</span>,<span class="st">&quot;rmd_printscr.png&quot;</span>))</span></code></pre></div>
<p><img src="images/rmd_printscr.png" width="539" /></p>
</div>
<div id="to-replicate-a-scientific-study-we-need-at-least" class="section level2" number="2.10">
<h2><span class="header-section-number">2.10</span> To replicate a scientific study we need at least:</h2>
<blockquote>
<ul>
<li>Scientific context, research questions and state of the art [<mark>P<mark/>]</li>
<li>(Experimental) model or characteristics of population or matter studied [<mark>P</mark>]</li>
<li>Data that was generated and corresponding meta data [<mark>D</mark>, <em>C</em>]</li>
<li><strong>Exact</strong> (experimental) design of the study [<mark>P</mark>, <em>D</em>, <mark>C</mark>]</li>
<li>Exploratory data analysis of the data [<em>P</em>, <mark>C</mark>]</li>
<li><strong>Exact</strong> methods that were used to conduct any formal inference [<em>P</em>, <mark>C</mark>]</li>
<li>Model diagnostics [<em>C</em>]</li>
<li>Interpretations of the (statistical) model results/model fitting process [<em>P</em>, <em>C</em>]</li>
<li>Conclusions and academic scoping of the results [<mark>P</mark>, <em>C</em>]</li>
<li><strong>Access to all of the above</strong> [<mark>OAcc, OSrc</mark>]</li>
</ul>
</blockquote>
<p style="font-size:14px">
<span class="math inline">\(P = Publication\)</span>, <span class="math inline">\(D = Data\)</span>, <span class="math inline">\(C = Code\)</span>, <span class="math inline">\(OAcc = Open\ Access\)</span>, <span class="math inline">\(OSrc = Open\ Source\)</span>
</p>
</div>
<div id="why-r" class="section level2" number="2.11">
<h2><span class="header-section-number">2.11</span> Why R?</h2>
<ul>
<li>R is free</li>
<li>R has a huge user-community</li>
<li>R has many packages</li>
<li>Many statistical applications (more than SPSS)</li>
<li>R connects to other tools</li>
<li>R has RStudio as an IDE</li>
<li>You can find (almost) every example you want on the internet</li>
<li>R has superb plotting possibilities
…</li>
</ul>
</div>
<div id="a-short-example-of-reproducible-open-science" class="section level2" number="2.12">
<h2><span class="header-section-number">2.12</span> A short example of Reproducible (Open) Science</h2>
<p>Assume we have the following question:
“Which of 4 types of chairs takes the least effort to arise from when seated in?”
We have the following setup:</p>
<ul>
<li>4 different types of chairs</li>
<li>9 different subjects (probably somewhat aged)</li>
<li>Each subject is required to provide a score (from 6 to 20, 6 being very lightly strenuous, 20 being extremely strenuous) when arising from each of the 4 chairs. There is some ‘wash-out’ time in between the trials. The chair order is randomised.</li>
</ul>
<p>To analyze this experiment statistically, the model would need to include: the rating score as the <strong>measured (or dependent) variable</strong>, the type of chair as the <strong>experimental factor</strong> and the subject as the <strong>blocking factor</strong></p>
</div>
<div id="now-we-move-to-rstudio" class="section level2" number="2.13">
<h2><span class="header-section-number">2.13</span> Now we move to RStudio</h2>
<ul>
<li>If you have 2 screens, now is the moment to expand the screen</li>
<li>Login to your Rstudio Environment</li>
<li>Clone the materials of the course to your <code>Home</code> folder</li>
<li>You can find the steps also in <code>_gettingstarted.Rmd</code></li>
<li>Open the file <code>_why_r.Rmd</code></li>
<li>Follow along the demo by running the code</li>
<li>Details on using RStudio can be found in <code>_introrstudio</code></li>
</ul>
</div>
<div id="mixed-effects-models" class="section level2" number="2.14">
<h2><span class="header-section-number">2.14</span> Mixed effects models</h2>
<p>A typical analysis method for this type of randomized block design is a so-called ‘multi-level’ or also called ‘mixed-effects’ or ‘hierarchical’ models. An analysis method much used in clinical or biological scientific practice.</p>
<p>You could also use one-way ANOVA but I will illustrate why this is not a good idea</p>
</div>
<div id="what-do-we-minimally-need-to-replicate-the-science-of-this-experiment" class="section level2 build" number="2.15">
<h2><span class="header-section-number">2.15</span> What do we minimally need, to replicate the science of this experiment?</h2>
<p>I will show:</p>
<blockquote>
<ul>
<li>the data</li>
<li>an exploratory graph</li>
<li>a statistical model</li>
<li>the statistical model results</li>
<li>a model diagnostic</li>
<li>some conclusions</li>
</ul>
</blockquote>
<p>In the next few slides, I will hopefully convince you of the power of (literate) programming to communicate such an analysis.</p>
<p style="font-size:14px">
<a href="https://cran.r-project.org/web/packages/nlme/index.html">Example reproduced from: Pinheiro and Bates, 2000, <em>Mixed-Effects Models in S and S-PLUS</em>, Springer, New York.</a>
</p>
</div>
<div id="the-data-of-the-experiment" class="section level2" number="2.16">
<h2><span class="header-section-number">2.16</span> The data of the experiment</h2>
<p style="font-size:14px">
<a href="https://doi.org/10.1080/00140139308967910">Wretenberg, Arborelius &amp; Lindberg, 1993</a>
</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="why-use-r.html#cb13-1"></a><span class="kw">library</span>(nlme)</span>
<span id="cb13-2"><a href="why-use-r.html#cb13-2"></a>ergoStool <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>()</span></code></pre></div>
<pre><code>## # A tibble: 36 x 3
##    effort Type  Subject
##     &lt;dbl&gt; &lt;fct&gt; &lt;ord&gt;  
##  1     12 T1    1      
##  2     15 T2    1      
##  3     12 T3    1      
##  4     10 T4    1      
##  5     10 T1    2      
##  6     14 T2    2      
##  7     13 T3    2      
##  8     12 T4    2      
##  9      7 T1    3      
## 10     14 T2    3      
## # ... with 26 more rows</code></pre>
</div>
<div id="an-exploratory-graph" class="section level2" number="2.17">
<h2><span class="header-section-number">2.17</span> An exploratory graph</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="why-use-r.html#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="why-use-r.html#cb15-2"></a>plot_ergo &lt;-<span class="st"> </span>ergoStool <span class="op">%&gt;%</span></span>
<span id="cb15-3"><a href="why-use-r.html#cb15-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(Type, effort), <span class="dt">y =</span> effort)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-4"><a href="why-use-r.html#cb15-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">colour =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-5"><a href="why-use-r.html#cb15-5"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">reorder</span>(Subject, <span class="op">-</span>effort)), </span>
<span id="cb15-6"><a href="why-use-r.html#cb15-6"></a>              <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb15-7"><a href="why-use-r.html#cb15-7"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;darkgrey&quot;</span>)) <span class="op">+</span></span>
<span id="cb15-8"><a href="why-use-r.html#cb15-8"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Effort (Borg scale score)&quot;</span>) <span class="op">+</span></span>
<span id="cb15-9"><a href="why-use-r.html#cb15-9"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Chair type&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-10"><a href="why-use-r.html#cb15-10"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Subject id&quot;</span>)) <span class="op">+</span></span>
<span id="cb15-11"><a href="why-use-r.html#cb15-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb15-12"><a href="why-use-r.html#cb15-12"></a>plot_ergo</span></code></pre></div>
<p><img src="ch01_why_r_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="mind-the-variability-per-subject-what-do-you-see" class="section level2" number="2.18">
<h2><span class="header-section-number">2.18</span> Mind the variability per subject, what do you see?</h2>
<ul>
<li>Can you say something about within-subject variability (note ‘Minster Blue’)?</li>
<li>Can you say something about between-subject variability (note ‘Mister Green’, vs ‘Mister Black’)?</li>
<li>Which chair type takes, on average the biggest effort to arise from?</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="why-use-r.html#cb16-1"></a>plot_ergo</span></code></pre></div>
<p><img src="ch01_why_r_files/figure-html/unnamed-chunk-7-1.png" width="480" /></p>
</div>
<div id="the-statistical-questions" class="section level2" number="2.19">
<h2><span class="header-section-number">2.19</span> The statistical questions</h2>
<ol style="list-style-type: decimal">
<li>Which chair type takes, on average the biggest effort to arise from? (ANOVA / MEM, fixed effects)</li>
</ol>
<ul>
<li>Do individual (within subject) differences play a role in appointing a average score to a chair type? (MEM, random effects)</li>
<li>Does variability between subjects play a role in determining the ‘best’ chair type (ANOVA / MEM, confidence intervals)</li>
</ul>
</div>
<div id="the-statistical-model" class="section level2" number="2.20">
<h2><span class="header-section-number">2.20</span> The statistical model</h2>
<p>Statistical models (in R) can be specified by a <code>model formula</code>. The left side of the formula is the dependent variable, the right side are the ‘predictors’. Here we include a <code>fixed</code> and a <code>random</code> term to the model (as is common for mixed-effects models)</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="why-use-r.html#cb17-1"></a><span class="kw">library</span>(nlme)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="why-use-r.html#cb18-1"></a>ergo_model &lt;-<span class="st"> </span><span class="kw">lme</span>(</span>
<span id="cb18-2"><a href="why-use-r.html#cb18-2"></a>  <span class="dt">data =</span> ergoStool, <span class="co"># the data to be used for the model</span></span>
<span id="cb18-3"><a href="why-use-r.html#cb18-3"></a>  <span class="dt">fixed =</span> effort <span class="op">~</span><span class="st"> </span>Type, <span class="co"># the dependent and fixed effects variables</span></span>
<span id="cb18-4"><a href="why-use-r.html#cb18-4"></a>  <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject <span class="co"># random intercepts for Subject variable</span></span>
<span id="cb18-5"><a href="why-use-r.html#cb18-5"></a>)</span></code></pre></div>
<p style="font-size:18px">
The <code>lme()</code> function is part of the <a href="https://cran.r-project.org/web/packages/nlme/index.html"><code>{nlme}</code></a> package for mixed effects modelling in R
</p>
<p style="font-size:18px">
Example reproduced from: <a href="https://cran.r-project.org/web/packages/nlme/index.html">Pinheiro and Bates, 2000, <em>Mixed-Effects Models in S and S-PLUS</em>, Springer, New York.</a>
</p>
</div>
<div id="the-statistical-results" class="section level2" number="2.21">
<h2><span class="header-section-number">2.21</span> The statistical results</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="why-use-r.html#cb19-1"></a>result &lt;-<span class="st"> </span>ergo_model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>() </span>
<span id="cb19-2"><a href="why-use-r.html#cb19-2"></a>result<span class="op">$</span>tTable <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Value</th>
<th align="right">Std.Error</th>
<th align="right">DF</th>
<th align="right">t-value</th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">8.5555556</td>
<td align="right">0.5760123</td>
<td align="right">24</td>
<td align="right">14.853079</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">TypeT2</td>
<td align="right">3.8888889</td>
<td align="right">0.5186838</td>
<td align="right">24</td>
<td align="right">7.497610</td>
<td align="right">0.0000001</td>
</tr>
<tr class="odd">
<td align="left">TypeT3</td>
<td align="right">2.2222222</td>
<td align="right">0.5186838</td>
<td align="right">24</td>
<td align="right">4.284348</td>
<td align="right">0.0002563</td>
</tr>
<tr class="even">
<td align="left">TypeT4</td>
<td align="right">0.6666667</td>
<td align="right">0.5186838</td>
<td align="right">24</td>
<td align="right">1.285305</td>
<td align="right">0.2109512</td>
</tr>
</tbody>
</table>
</div>
<div id="model-diagnostics" class="section level2 build" number="2.22">
<h2><span class="header-section-number">2.22</span> Model diagnostics</h2>
<blockquote>
<ul>
<li>Diagnostics of a fitted model is the most important step in a statistical analysis</li>
<li>In most scientific papers the details are lacking</li>
<li>Did the authors omit to perform this step? Or did they not report it?</li>
<li>If you do not want to include it in your paper, put it in an appendix!</li>
</ul>
</blockquote>
</div>
<div id="residuals" class="section level2" number="2.23">
<h2><span class="header-section-number">2.23</span> Residuals</h2>
<p>A residual plot shows the ‘residual’ error (‘unexplained variance’) after fitting the model. Under the Normality assumption standardized residuals should:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>Be normally distributed around 0</li>
<li>Display no obvious ‘patters’</li>
<li>Should display overall equal ‘spread’ above and below 0 (‘assumption of equal variance’)</li>
</ol>
</blockquote>
</div>
<div id="residual-plot" class="section level2" number="2.24">
<h2><span class="header-section-number">2.24</span> Residual plot</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="why-use-r.html#cb20-1"></a><span class="kw">plot</span>(ergo_model) <span class="co">## type = &#39;pearson&#39; (standardized residuals)</span></span></code></pre></div>
<p><img src="ch01_why_r_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="the-conclusions-in-a-plot" class="section level2" number="2.25">
<h2><span class="header-section-number">2.25</span> The conclusions in a plot</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="why-use-r.html#cb21-1"></a><span class="co"># install.packages(&quot;ggsignif&quot;)</span></span>
<span id="cb21-2"><a href="why-use-r.html#cb21-2"></a><span class="kw">library</span>(ggsignif)</span>
<span id="cb21-3"><a href="why-use-r.html#cb21-3"></a>p_values &lt;-<span class="st"> </span>result<span class="op">$</span>tTable <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>()</span>
<span id="cb21-4"><a href="why-use-r.html#cb21-4"></a>annotation_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Type=</span><span class="kw">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;T2&quot;</span>), </span>
<span id="cb21-5"><a href="why-use-r.html#cb21-5"></a>                            <span class="dt">start=</span><span class="kw">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;T1&quot;</span>), </span>
<span id="cb21-6"><a href="why-use-r.html#cb21-6"></a>                            <span class="dt">end=</span><span class="kw">c</span>(<span class="st">&quot;T2&quot;</span>, <span class="st">&quot;T3&quot;</span>),</span>
<span id="cb21-7"><a href="why-use-r.html#cb21-7"></a>                            <span class="dt">y=</span><span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">14</span>),</span>
<span id="cb21-8"><a href="why-use-r.html#cb21-8"></a>                            <span class="dt">label=</span></span>
<span id="cb21-9"><a href="why-use-r.html#cb21-9"></a>                              <span class="kw">paste</span>(<span class="st">&quot;p-value:&quot;</span>,</span>
<span id="cb21-10"><a href="why-use-r.html#cb21-10"></a>                              <span class="kw">c</span>(</span>
<span id="cb21-11"><a href="why-use-r.html#cb21-11"></a>                              <span class="kw">formatC</span>(</span>
<span id="cb21-12"><a href="why-use-r.html#cb21-12"></a>                                p_values<span class="op">$</span><span class="st">`</span><span class="dt">p-value</span><span class="st">`</span>[<span class="dv">2</span>], <span class="dt">digits =</span> <span class="dv">3</span>),</span>
<span id="cb21-13"><a href="why-use-r.html#cb21-13"></a>                              <span class="kw">formatC</span>(</span>
<span id="cb21-14"><a href="why-use-r.html#cb21-14"></a>                                p_values<span class="op">$</span><span class="st">`</span><span class="dt">p-value</span><span class="st">`</span>[<span class="dv">3</span>], <span class="dt">digits =</span> <span class="dv">3</span>)</span>
<span id="cb21-15"><a href="why-use-r.html#cb21-15"></a>                              )</span>
<span id="cb21-16"><a href="why-use-r.html#cb21-16"></a>                            )</span>
<span id="cb21-17"><a href="why-use-r.html#cb21-17"></a>                          )</span>
<span id="cb21-18"><a href="why-use-r.html#cb21-18"></a>                            </span>
<span id="cb21-19"><a href="why-use-r.html#cb21-19"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb21-20"><a href="why-use-r.html#cb21-20"></a>ergoStool <span class="op">%&gt;%</span></span>
<span id="cb21-21"><a href="why-use-r.html#cb21-21"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(Type, effort), </span>
<span id="cb21-22"><a href="why-use-r.html#cb21-22"></a>             <span class="dt">y =</span> effort)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-23"><a href="why-use-r.html#cb21-23"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">colour =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb21-24"><a href="why-use-r.html#cb21-24"></a>               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-25"><a href="why-use-r.html#cb21-25"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(</span>
<span id="cb21-26"><a href="why-use-r.html#cb21-26"></a>    <span class="dt">colour =</span> <span class="kw">reorder</span>(Subject, <span class="op">-</span>effort)), </span>
<span id="cb21-27"><a href="why-use-r.html#cb21-27"></a>    <span class="dt">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb21-28"><a href="why-use-r.html#cb21-28"></a>    <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb21-29"><a href="why-use-r.html#cb21-29"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(</span>
<span id="cb21-30"><a href="why-use-r.html#cb21-30"></a>    <span class="dt">values =</span> <span class="kw">c</span>(</span>
<span id="cb21-31"><a href="why-use-r.html#cb21-31"></a>      <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>, </span>
<span id="cb21-32"><a href="why-use-r.html#cb21-32"></a>      <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb21-33"><a href="why-use-r.html#cb21-33"></a>      <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>, </span>
<span id="cb21-34"><a href="why-use-r.html#cb21-34"></a>      <span class="st">&quot;darkgrey&quot;</span>)) <span class="op">+</span></span>
<span id="cb21-35"><a href="why-use-r.html#cb21-35"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Effort (Borg scale score)&quot;</span>) <span class="op">+</span></span>
<span id="cb21-36"><a href="why-use-r.html#cb21-36"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Chair type&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-37"><a href="why-use-r.html#cb21-37"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Subject id&quot;</span>)) <span class="op">+</span></span>
<span id="cb21-38"><a href="why-use-r.html#cb21-38"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">20</span>)) <span class="op">+</span></span>
<span id="cb21-39"><a href="why-use-r.html#cb21-39"></a><span class="st">  </span><span class="kw">geom_signif</span>(</span>
<span id="cb21-40"><a href="why-use-r.html#cb21-40"></a>    <span class="dt">data=</span>annotation_df,</span>
<span id="cb21-41"><a href="why-use-r.html#cb21-41"></a>    <span class="kw">aes</span>(<span class="dt">xmin=</span>start, </span>
<span id="cb21-42"><a href="why-use-r.html#cb21-42"></a>    <span class="dt">xmax=</span>end, </span>
<span id="cb21-43"><a href="why-use-r.html#cb21-43"></a>    <span class="dt">annotations=</span>label, </span>
<span id="cb21-44"><a href="why-use-r.html#cb21-44"></a>    <span class="dt">y_position=</span>y),</span>
<span id="cb21-45"><a href="why-use-r.html#cb21-45"></a>    <span class="dt">textsize =</span> <span class="dv">5</span>, <span class="dt">vjust =</span> <span class="fl">-0.2</span>,</span>
<span id="cb21-46"><a href="why-use-r.html#cb21-46"></a>    <span class="dt">manual=</span><span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb21-47"><a href="why-use-r.html#cb21-47"></a><span class="st">  </span><span class="kw">theme_bw</span>() -&gt;<span class="st"> </span>plot_ergo</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown aesthetics: xmin, xmax, annotations, y_position</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="why-use-r.html#cb23-1"></a>plot_ergo</span></code></pre></div>
<p><img src="ch01_why_r_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="coming-from-spss-or-excel-or-the-likes" class="section level2" number="2.26">
<h2><span class="header-section-number">2.26</span> Coming from SPSS or Excel or the likes</h2>
<ul>
<li>You have to unlearn what you learned</li>
<li>You already know about performing statistical analysis and maybe also coding (SPSS syntax)</li>
<li>IBM (SPSS) is proprietary</li>
<li>I will take time to transfer</li>
<li>Try a hard-stop: so do not mix tools</li>
<li>Programming (in R) is hard and takes</li>
<li>I cannot learn you programming, you will have to do it yourself</li>
<li>Start with the book: “R for Data Science”</li>
<li><strong>Write code for humans!</strong></li>
</ul>
</div>
<div id="and-the-most-important-part" class="section level2" number="2.27">
<h2><span class="header-section-number">2.27</span> And the most important part…</h2>
<p>– Coffee break –</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gettingstarted.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uashogeschoolutrecht/staRters/edit/master/ch01_why_r.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["exploratory_data_analysis.pdf", "exploratory_data_analysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
