<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Sampling, Probability distributions and bootstrapping | staRters; An introductory workshop for analysis of data with R</title>
  <meta name="description" content="HU Ontwikkelfestival, 2-4 November, 2020" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Sampling, Probability distributions and bootstrapping | staRters; An introductory workshop for analysis of data with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="HU Ontwikkelfestival, 2-4 November, 2020" />
  <meta name="github-repo" content="uashogeschoolutrecht/staRters" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Sampling, Probability distributions and bootstrapping | staRters; An introductory workshop for analysis of data with R" />
  
  <meta name="twitter:description" content="HU Ontwikkelfestival, 2-4 November, 2020" />
  

<meta name="author" content="Marc A.T. Teunis, PhD" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="assumptions.html"/>
<link rel="next" href="resources.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/d3-5.7.0/d3.min.js"></script>
<script src="libs/d3-lasso-0.0.5/d3-lasso.min.js"></script>
<link href="libs/ggiraphjs-0.3.0/ggiraphjs.min.css" rel="stylesheet" />
<script src="libs/ggiraphjs-0.3.0/ggiraphjs.min.js"></script>
<script src="libs/girafe-binding-0.7.8/girafe.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis with R for staRters</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="why-r.html"><a href="why-r.html"><i class="fa fa-check"></i><b>2</b> Why use R?</a></li>
<li class="chapter" data-level="3" data-path="gettingstarted.html"><a href="gettingstarted.html"><i class="fa fa-check"></i><b>3</b> Getting Started</a></li>
<li class="chapter" data-level="4" data-path="edacase.html"><a href="edacase.html"><i class="fa fa-check"></i><b>4</b> Case Example</a></li>
<li class="chapter" data-level="5" data-path="introrstudio.html"><a href="introrstudio.html"><i class="fa fa-check"></i><b>5</b> Introduction to RStudio</a></li>
<li class="chapter" data-level="6" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>6</b> Literate Programming with RMarkdown</a></li>
<li class="chapter" data-level="7" data-path="intror.html"><a href="intror.html"><i class="fa fa-check"></i><b>7</b> Introduction to R</a></li>
<li class="chapter" data-level="8" data-path="recursivevectors.html"><a href="recursivevectors.html"><i class="fa fa-check"></i><b>8</b> Lists and dataframes</a></li>
<li class="chapter" data-level="9" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>9</b> Visualize &amp; Explore Data</a></li>
<li class="chapter" data-level="10" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>10</b> Data Wrangling</a></li>
<li class="chapter" data-level="11" data-path="tidydata.html"><a href="tidydata.html"><i class="fa fa-check"></i><b>11</b> Tidy Data</a></li>
<li class="chapter" data-level="12" data-path="importingdata.html"><a href="importingdata.html"><i class="fa fa-check"></i><b>12</b> Importing data</a></li>
<li class="chapter" data-level="13" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>13</b> Assumptions and statistical models</a></li>
<li class="chapter" data-level="14" data-path="sampling-bootstrapping.html"><a href="sampling-bootstrapping.html"><i class="fa fa-check"></i><b>14</b> Sampling, Probability distributions and bootstrapping</a></li>
<li class="chapter" data-level="15" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>15</b> Resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/uashogeschoolutrecht/staRters" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">staRters; An introductory workshop for analysis of data with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling_bootstrapping" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Sampling, Probability distributions and bootstrapping</h1>
<div id="packages" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Packages</h2>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="sampling-bootstrapping.html#cb895-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Data</h2>
<p>For this chapter we use data from the ‘Freie Universitaet’ Berlin downloaded from: <a href="https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/Continous-Random-Variables/The-Standard-Normal-Distribution/The-Standard-Normal-Distribution-An-Example/index.html" class="uri">https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/Continous-Random-Variables/The-Standard-Normal-Distribution/The-Standard-Normal-Distribution-An-Example/index.html</a></p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="sampling-bootstrapping.html#cb896-1"></a>data_students &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb896-2"><a href="sampling-bootstrapping.html#cb896-2"></a><span class="st">  </span><span class="kw">as_tibble</span>()</span>
<span id="cb896-3"><a href="sampling-bootstrapping.html#cb896-3"></a>data_students</span></code></pre></div>
<pre><code>## # A tibble: 8,239 x 16
##    stud.id name  gender   age height weight religion nc.score semester major
##      &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;
##  1  833917 Gonz~ Female    19    160   64.8 Muslim       1.91 1st      Poli~
##  2  898539 Loza~ Female    19    172   73   Other        1.56 2nd      Soci~
##  3  379678 Will~ Female    22    168   70.6 Protest~     1.24 3rd      Soci~
##  4  807564 Nem,~ Male      19    183   79.7 Other        1.37 2nd      Envi~
##  5  383291 Powe~ Female    21    175   71.4 Catholic     1.46 1st      Envi~
##  6  256074 Pere~ Male      19    189   85.8 Catholic     1.34 2nd      Poli~
##  7  754591 Clar~ Female    21    156   65.9 Protest~     1.11 2nd      Poli~
##  8  146494 Alle~ Female    21    167   65.7 Other        2.03 3rd      Poli~
##  9  723584 Trac~ Male      18    195   94.4 Other        1.29 3rd      Econ~
## 10  314281 Nimm~ Female    18    165   66   Orthodox     1.19 2nd      Envi~
## # ... with 8,229 more rows, and 6 more variables: minor &lt;chr&gt;, score1 &lt;int&gt;,
## #   score2 &lt;int&gt;, online.tutorial &lt;int&gt;, graduated &lt;int&gt;, salary &lt;dbl&gt;</code></pre>
<p>In this chapter we will be working with the <code>height</code> and <code>age</code> column of the <code>data_students</code> data frame. Let’s make a few exploratory graphs, to see how they relate to each other and to see some characteristics of the data.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="sampling-bootstrapping.html#cb898-1"></a><span class="co">## relationship between weight, height and gender</span></span>
<span id="cb898-2"><a href="sampling-bootstrapping.html#cb898-2"></a>data_students <span class="op">%&gt;%</span></span>
<span id="cb898-3"><a href="sampling-bootstrapping.html#cb898-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> weight)) <span class="op">+</span></span>
<span id="cb898-4"><a href="sampling-bootstrapping.html#cb898-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> gender), <span class="dt">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="sampling-bootstrapping.html#cb899-1"></a><span class="co">## distribution of weight</span></span>
<span id="cb899-2"><a href="sampling-bootstrapping.html#cb899-2"></a>data_students <span class="op">%&gt;%</span></span>
<span id="cb899-3"><a href="sampling-bootstrapping.html#cb899-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight)) <span class="op">+</span></span>
<span id="cb899-4"><a href="sampling-bootstrapping.html#cb899-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> gender), <span class="dt">bins =</span> <span class="dv">70</span>)</span></code></pre></div>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="sampling-bootstrapping.html#cb900-1"></a><span class="co">## distribution of height</span></span>
<span id="cb900-2"><a href="sampling-bootstrapping.html#cb900-2"></a>data_students <span class="op">%&gt;%</span></span>
<span id="cb900-3"><a href="sampling-bootstrapping.html#cb900-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height)) <span class="op">+</span></span>
<span id="cb900-4"><a href="sampling-bootstrapping.html#cb900-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> gender), <span class="dt">bins =</span> <span class="dv">70</span>)</span></code></pre></div>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="sampling-bootstrapping.html#cb901-1"></a><span class="co">## missingness</span></span></code></pre></div>
<p>We can use the distributions of height variable to learn something about probablities and the normal distribution.</p>
</div>
<div id="probability-distributions-and-predictions" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Probability distributions and predictions</h2>
<p>First calculate the sample mean (<span class="math inline">\(\overline{x}\)</span>), and the standard deviation of the sample mean <span class="math inline">\(S_x\)</span>, of the target variable (in this case the <code>height</code> variable in the <code>data_students</code> data frame. Then, we standardize the <code>height</code> variable to get a standard normal distribution with <span class="math inline">\(\overline{x} = 0\)</span> and <span class="math inline">\(S_x = 1\)</span> and assign it to an appropriate variable name.</p>
<p>The formula for culculating the standard deviation of the sample mean is:</p>
<p><span class="math inline">\(\Large s_x = \sqrt{\frac{\sum_{i=1}^N (x_i - \overline{x})^2}{N-1}}\)</span></p>
</div>
<div id="exercise-1.-calculating-the-stardard-deviation" class="section level2 unnumbered" number="">
<h2><mark>EXERCISE 1. Calculating the stardard deviation</mark></h2>
<ol style="list-style-type: lower-alpha">
<li><p>Calculate the standard deviation (<span class="math inline">\(s_x\)</span>) of the sample mean by writing an expression in R that implements the above formula.</p></li>
<li><p>Use the function <code>mean()</code> to calculate the sample mean (<span class="math inline">\(\overline{x}\)</span>), store it in a variable in R called <code>mean_height</code></p></li>
<li><p>and the function <code>sd()</code> to confirm your ‘manual’ calculations, store it in a variable called <code>sd_height</code></p></li>
</ol>
<p><strong>TIPS</strong></p>
<ul>
<li>The <span class="math inline">\(N-1\)</span> bit are the degrees of freedom, it is the number of observations in this case minus <code>1</code></li>
<li>If you are struggling with the order in which to calculate things, extract out the different pieces of the calculations first, then put them back together (use in-between steps)</li>
<li>If you are not sure, look at the answer for c) to check your calculations</li>
<li>The R function for the root-square (‘Wortel’ in Dutch) is <code>sqrt()</code></li>
<li>To use power (‘Tot de macht’ in Dutch) in R use the caret (<code>^</code>) (which is something else than a carrot)</li>
<li>The numerator is the top part of the fraction, the denominator is the bottom part. The numerator here is also called the sum of squares for the sample.</li>
</ul>
<p><mark>— END OF EXERCISE —</mark></p>
</div>
<div id="z-transformation-of-the-female-observations" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Z-transformation of the female observations</h2>
<p>We already saw that gender makes a difference for the distribution of height. In the exploratory graphs, we see again the distributions looking normal if you split by gender. Of course, only looking at a distribution will not tell you whether the data is normally distributed. In the previous chapter (<a href="assumptions.html#assumptions">13</a>) we saw a more formal way of determining the nature of this distribution. For the remainder of this chapter we will be working with observations from the <code>data_students</code> that are labeled ‘Female’ in the <code>gender</code> variable.</p>
<p>Here we store the ‘Female’ data in a separate data frame and transform the female sample distribution to a standard normal distribution.</p>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="sampling-bootstrapping.html#cb902-1"></a>females &lt;-<span class="st"> </span>data_students <span class="op">%&gt;%</span></span>
<span id="cb902-2"><a href="sampling-bootstrapping.html#cb902-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(gender <span class="op">==</span><span class="st"> &quot;Female&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb902-3"><a href="sampling-bootstrapping.html#cb902-3"></a><span class="st">  </span><span class="kw">as_tibble</span>()</span>
<span id="cb902-4"><a href="sampling-bootstrapping.html#cb902-4"></a></span>
<span id="cb902-5"><a href="sampling-bootstrapping.html#cb902-5"></a>females</span></code></pre></div>
<pre><code>## # A tibble: 4,110 x 16
##    stud.id name  gender   age height weight religion nc.score semester major
##      &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;
##  1  833917 Gonz~ Female    19    160   64.8 Muslim       1.91 1st      Poli~
##  2  898539 Loza~ Female    19    172   73   Other        1.56 2nd      Soci~
##  3  379678 Will~ Female    22    168   70.6 Protest~     1.24 3rd      Soci~
##  4  383291 Powe~ Female    21    175   71.4 Catholic     1.46 1st      Envi~
##  5  754591 Clar~ Female    21    156   65.9 Protest~     1.11 2nd      Poli~
##  6  146494 Alle~ Female    21    167   65.7 Other        2.03 3rd      Poli~
##  7  314281 Nimm~ Female    18    165   66   Orthodox     1.19 2nd      Envi~
##  8  200803 Lang~ Female    22    162   66.8 Other        1.04 4th      Econ~
##  9  444907 Rodr~ Female    18    172   66.8 Other        3.81 3rd      Envi~
## 10  317812 Lope~ Female    20    158   64.4 Catholic     2.5  6th      Envi~
## # ... with 4,100 more rows, and 6 more variables: minor &lt;chr&gt;, score1 &lt;int&gt;,
## #   score2 &lt;int&gt;, online.tutorial &lt;int&gt;, graduated &lt;int&gt;, salary &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="sampling-bootstrapping.html#cb904-1"></a>mean_height_f &lt;-<span class="st"> </span><span class="kw">mean</span>(females<span class="op">$</span>height)</span>
<span id="cb904-2"><a href="sampling-bootstrapping.html#cb904-2"></a>sd_height_f &lt;-<span class="st"> </span><span class="kw">sd</span>(females<span class="op">$</span>height)</span>
<span id="cb904-3"><a href="sampling-bootstrapping.html#cb904-3"></a>height_z &lt;-<span class="st"> </span>(females<span class="op">$</span>height <span class="op">-</span><span class="st"> </span>mean_height_f)<span class="op">/</span>sd_height_f</span>
<span id="cb904-4"><a href="sampling-bootstrapping.html#cb904-4"></a>height_z <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">hist</span>(<span class="dt">main =</span> <span class="st">&quot;Z-transformed, female height&quot;</span>)</span></code></pre></div>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The female height variable has a mean of 163.7 cm of and a standard deviation of 7.92 cm.</p>
<p>If we assume the sample in the data is a proper representation of the complete population, We can make predictions about the chance of observing females with a specific height or height-range by finding the area to the left of a (or between) z-score(s)</p>
<p>Question 1
What is the probability of a randomly picked female student from the student data set with a height less or equal to 168 cm. Thus, we are looking for $P(x ≤ 168)</p>
<p>First, we calculate the probability for the standardized variable. Therefore, we have to transform our value of interest (168 cm) into a z-score.</p>
<p><span class="math inline">\(\Large z = \frac{x−\overline{x}}{S_x} = \frac{168−163.7}{7.9} = 0.55\)</span></p>
<p>Then we have to calculate the area under the curve left to the obtained z-score. We can calculate this area under the curve of a normal distributed variable by using the <code>pnorm()</code> function. The <code>pnorm()</code> function is written as <code>pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code>. For this particular example we can accept all default argument values.</p>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="sampling-bootstrapping.html#cb905-1"></a>x &lt;-<span class="st"> </span><span class="dv">168</span> <span class="co"># height in cm (that we want the probability for)</span></span>
<span id="cb905-2"><a href="sampling-bootstrapping.html#cb905-2"></a>x_z &lt;-<span class="st"> </span>(x <span class="op">-</span><span class="st"> </span>mean_height_f)<span class="op">/</span>sd_height_f <span class="co"># z-transformation</span></span>
<span id="cb905-3"><a href="sampling-bootstrapping.html#cb905-3"></a><span class="kw">pnorm</span>(x_z) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.71</code></pre>
<p>Awesome, we have a result:</p>
<p><span class="math inline">\(\Large P(z≤0.55) ≈ 0.71\)</span></p>
<p>Now, we do the same calculation, however this time we skip the step of standardization. Thanks to the power of R we do not need to rely on tables, but can we can easily put the sample mean, <span class="math inline">\(\overline{x}\)</span> and the sample standard deviation, <span class="math inline">\(S_x\)</span> into the <code>pnorm()</code> function.</p>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="sampling-bootstrapping.html#cb907-1"></a>x &lt;-<span class="st"> </span><span class="dv">168</span> <span class="co"># height in cm </span></span>
<span id="cb907-2"><a href="sampling-bootstrapping.html#cb907-2"></a><span class="kw">pnorm</span>(x, </span>
<span id="cb907-3"><a href="sampling-bootstrapping.html#cb907-3"></a>      <span class="dt">mean =</span> mean_height_f, </span>
<span id="cb907-4"><a href="sampling-bootstrapping.html#cb907-4"></a>      <span class="dt">sd =</span> sd_height_f, </span>
<span id="cb907-5"><a href="sampling-bootstrapping.html#cb907-5"></a>      <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>, <span class="dt">log.p =</span> <span class="ot">FALSE</span></span>
<span id="cb907-6"><a href="sampling-bootstrapping.html#cb907-6"></a>      ) <span class="op">%&gt;%</span></span>
<span id="cb907-7"><a href="sampling-bootstrapping.html#cb907-7"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.708</code></pre>
<p>The numbers are not identical but they are comparable:</p>
<p>$P(x ≤ 168) ≈ 0.708.
To make sure we realize what is going on, both the area under the curve for the standardized variable in z-values (left panel) as well as the area for the non-standardized variable in cm (right panel) are visualized below.</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="sampling-bootstrapping.html#cb909-1"></a>z_prob &lt;-<span class="st"> </span><span class="kw">ggplot</span>(females, <span class="kw">aes</span>(<span class="dt">x =</span> height_z)) <span class="op">+</span></span>
<span id="cb909-2"><a href="sampling-bootstrapping.html#cb909-2"></a><span class="kw">stat_function</span>(</span>
<span id="cb909-3"><a href="sampling-bootstrapping.html#cb909-3"></a><span class="dt">fun =</span> dnorm,</span>
<span id="cb909-4"><a href="sampling-bootstrapping.html#cb909-4"></a><span class="dt">args =</span> <span class="kw">with</span>(females, <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(height_z), <span class="dt">sd =</span> <span class="kw">sd</span>(height_z)))</span>
<span id="cb909-5"><a href="sampling-bootstrapping.html#cb909-5"></a>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_function</span>(</span>
<span id="cb909-6"><a href="sampling-bootstrapping.html#cb909-6"></a>  <span class="dt">args =</span> <span class="kw">with</span>(females, <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(height_z), <span class="dt">sd =</span> <span class="kw">sd</span>(height_z))),</span>
<span id="cb909-7"><a href="sampling-bootstrapping.html#cb909-7"></a>    <span class="dt">fun =</span> dnorm,</span>
<span id="cb909-8"><a href="sampling-bootstrapping.html#cb909-8"></a>    <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb909-9"><a href="sampling-bootstrapping.html#cb909-9"></a>    <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb909-10"><a href="sampling-bootstrapping.html#cb909-10"></a>    <span class="dt">alpha =</span> <span class="fl">.5</span>,</span>
<span id="cb909-11"><a href="sampling-bootstrapping.html#cb909-11"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">3.5</span>, <span class="fl">0.55</span>)) <span class="op">+</span></span>
<span id="cb909-12"><a href="sampling-bootstrapping.html#cb909-12"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;P(z =&lt; 0.55&quot;</span>) <span class="op">+</span></span>
<span id="cb909-13"><a href="sampling-bootstrapping.html#cb909-13"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Z-transformed height&quot;</span>) <span class="op">+</span></span>
<span id="cb909-14"><a href="sampling-bootstrapping.html#cb909-14"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb909-15"><a href="sampling-bootstrapping.html#cb909-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb909-16"><a href="sampling-bootstrapping.html#cb909-16"></a>        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</span>
<span id="cb909-17"><a href="sampling-bootstrapping.html#cb909-17"></a></span>
<span id="cb909-18"><a href="sampling-bootstrapping.html#cb909-18"></a></span>
<span id="cb909-19"><a href="sampling-bootstrapping.html#cb909-19"></a>real_prob &lt;-<span class="st"> </span><span class="kw">ggplot</span>(females, <span class="kw">aes</span>(<span class="dt">x =</span> height)) <span class="op">+</span></span>
<span id="cb909-20"><a href="sampling-bootstrapping.html#cb909-20"></a><span class="kw">stat_function</span>(</span>
<span id="cb909-21"><a href="sampling-bootstrapping.html#cb909-21"></a><span class="dt">fun =</span> dnorm,</span>
<span id="cb909-22"><a href="sampling-bootstrapping.html#cb909-22"></a><span class="dt">args =</span> <span class="kw">with</span>(females, <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(height), <span class="dt">sd =</span> <span class="kw">sd</span>(height)))</span>
<span id="cb909-23"><a href="sampling-bootstrapping.html#cb909-23"></a>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_function</span>(</span>
<span id="cb909-24"><a href="sampling-bootstrapping.html#cb909-24"></a>  <span class="dt">args =</span> <span class="kw">with</span>(females, <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(height), <span class="dt">sd =</span> <span class="kw">sd</span>(height))),</span>
<span id="cb909-25"><a href="sampling-bootstrapping.html#cb909-25"></a>    <span class="dt">fun =</span> dnorm,</span>
<span id="cb909-26"><a href="sampling-bootstrapping.html#cb909-26"></a>    <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb909-27"><a href="sampling-bootstrapping.html#cb909-27"></a>    <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb909-28"><a href="sampling-bootstrapping.html#cb909-28"></a>    <span class="dt">alpha =</span> <span class="fl">.5</span>,</span>
<span id="cb909-29"><a href="sampling-bootstrapping.html#cb909-29"></a>  <span class="dt">xlim  =</span> <span class="kw">c</span>(<span class="dv">135</span>, <span class="dv">168</span>)) <span class="op">+</span></span>
<span id="cb909-30"><a href="sampling-bootstrapping.html#cb909-30"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;P x =&lt; 168 cm&quot;</span>) <span class="op">+</span></span>
<span id="cb909-31"><a href="sampling-bootstrapping.html#cb909-31"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Height (cm)&quot;</span>) <span class="op">+</span></span>
<span id="cb909-32"><a href="sampling-bootstrapping.html#cb909-32"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb909-33"><a href="sampling-bootstrapping.html#cb909-33"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb909-34"><a href="sampling-bootstrapping.html#cb909-34"></a>        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</span>
<span id="cb909-35"><a href="sampling-bootstrapping.html#cb909-35"></a></span>
<span id="cb909-36"><a href="sampling-bootstrapping.html#cb909-36"></a>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(z_prob, real_prob)</span></code></pre></div>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="sampling-distributions" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Sampling distributions</h2>
<p>Based upon our intuition of randomness in the sampling process, we introduce the Sampling Distribution. The sampling distribution is a distribution of a sample statistic. Often the name of the computed statistic is added as part of the title. For example, if the computed statistic was the sample mean, the sampling distribution would be titled the <code>sampling distribution of the sample mean</code>.</p>
<p>Let’s assume we have a population that is represented by 5961 randomly generated numbers from a Normally distributed collections of numbers. If we repeatedly sample from that population and each time compute the sample statistic (e.g. <span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(s_x\)</span>, the resulting distribution of sample statistics is called the sampling distribution of that statistic. We pre-define the mean of population at <code>24</code> and set the standard deviation of that mean to <code>7.9</code>. Because by definition a normal distributed population is defined by the mean (<span class="math inline">\(\mu\)</span>) and the standard deviation of <span class="math inline">\(\mu\)</span> called <span class="math inline">\(\sigma\)</span>.</p>
<p>Normally, we do not know what the population distribution looks like. This would be information we do NOT have (hence, we need to sample the population to get an estimate of this distribution. This is often the aim of inferential statistics. Because we would like to know how good we did on our sampling we need some form of assessment for this. The exercise below, hopefully helps you understand this need.</p>
<p>Let us take repeatedly random samples (<span class="math inline">\(x_1\)</span> to <span class="math inline">\(xn\)</span>)
without replacement of sizes where <span class="math inline">\(n\)</span> is . We take these samples randomly from the population to determine the <code>sampling distribution of the sample mean</code>.</p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="sampling-bootstrapping.html#cb910-1"></a><span class="co"># set.seed() is for reproducibility</span></span>
<span id="cb910-2"><a href="sampling-bootstrapping.html#cb910-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb910-3"><a href="sampling-bootstrapping.html#cb910-3"></a><span class="co"># define opulation and put in a dataframe</span></span>
<span id="cb910-4"><a href="sampling-bootstrapping.html#cb910-4"></a>population &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">mean =</span> <span class="dv">24</span>, <span class="dt">sd =</span> <span class="fl">7.9</span>, <span class="dt">n =</span> <span class="dv">5961</span>) <span class="op">%&gt;%</span></span>
<span id="cb910-5"><a href="sampling-bootstrapping.html#cb910-5"></a><span class="st">  </span><span class="kw">enframe</span>()</span>
<span id="cb910-6"><a href="sampling-bootstrapping.html#cb910-6"></a></span>
<span id="cb910-7"><a href="sampling-bootstrapping.html#cb910-7"></a><span class="co">## see a fast picture of how the population distribution looks like (it should )</span></span>
<span id="cb910-8"><a href="sampling-bootstrapping.html#cb910-8"></a><span class="co">## normally this would be information we do NOT have (hence, we need to sample the population to get an estimate of this distribution)</span></span>
<span id="cb910-9"><a href="sampling-bootstrapping.html#cb910-9"></a>population <span class="op">%&gt;%</span></span>
<span id="cb910-10"><a href="sampling-bootstrapping.html#cb910-10"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ))</span></code></pre></div>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="sampling-bootstrapping.html#cb911-1"></a><span class="co">## what is the mean?</span></span>
<span id="cb911-2"><a href="sampling-bootstrapping.html#cb911-2"></a><span class="kw">mean</span>(population<span class="op">$</span>value)</span></code></pre></div>
<pre><code>## [1] 24.03374</code></pre>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="sampling-bootstrapping.html#cb913-1"></a><span class="co">## define the sample-sized that we want to draw from the population</span></span>
<span id="cb913-2"><a href="sampling-bootstrapping.html#cb913-2"></a>no_samples &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="kw">length</span>(population<span class="op">$</span>value))</span>
<span id="cb913-3"><a href="sampling-bootstrapping.html#cb913-3"></a></span>
<span id="cb913-4"><a href="sampling-bootstrapping.html#cb913-4"></a><span class="co">## draw random samples of size `no_samples` from the population</span></span>
<span id="cb913-5"><a href="sampling-bootstrapping.html#cb913-5"></a><span class="co">## we construct a loop by using map from the purrr package</span></span>
<span id="cb913-6"><a href="sampling-bootstrapping.html#cb913-6"></a>samples &lt;-<span class="st"> </span><span class="kw">map</span>(</span>
<span id="cb913-7"><a href="sampling-bootstrapping.html#cb913-7"></a>  <span class="dt">.x =</span> no_samples,</span>
<span id="cb913-8"><a href="sampling-bootstrapping.html#cb913-8"></a>  <span class="dt">.f =</span> sample_n,</span>
<span id="cb913-9"><a href="sampling-bootstrapping.html#cb913-9"></a>  <span class="dt">tbl =</span> population,</span>
<span id="cb913-10"><a href="sampling-bootstrapping.html#cb913-10"></a>  <span class="dt">replace =</span> <span class="ot">FALSE</span></span>
<span id="cb913-11"><a href="sampling-bootstrapping.html#cb913-11"></a>)</span>
<span id="cb913-12"><a href="sampling-bootstrapping.html#cb913-12"></a></span>
<span id="cb913-13"><a href="sampling-bootstrapping.html#cb913-13"></a><span class="co">## function to plot the draws from the population</span></span>
<span id="cb913-14"><a href="sampling-bootstrapping.html#cb913-14"></a>plot_bootstrap &lt;-<span class="st"> </span><span class="cf">function</span>(bootstrap_tbl, mu, <span class="dt">size =</span> <span class="dv">1</span>){</span>
<span id="cb913-15"><a href="sampling-bootstrapping.html#cb913-15"></a></span>
<span id="cb913-16"><a href="sampling-bootstrapping.html#cb913-16"></a>  bootstrap_tbl <span class="op">%&gt;%</span></span>
<span id="cb913-17"><a href="sampling-bootstrapping.html#cb913-17"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb913-18"><a href="sampling-bootstrapping.html#cb913-18"></a><span class="st">    </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb913-19"><a href="sampling-bootstrapping.html#cb913-19"></a><span class="st"> </span><span class="co">#   xlim(c(1,100)) +</span></span>
<span id="cb913-20"><a href="sampling-bootstrapping.html#cb913-20"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mu, </span>
<span id="cb913-21"><a href="sampling-bootstrapping.html#cb913-21"></a>               <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb913-22"><a href="sampling-bootstrapping.html#cb913-22"></a>               <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb913-23"><a href="sampling-bootstrapping.html#cb913-23"></a>               <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb913-24"><a href="sampling-bootstrapping.html#cb913-24"></a>  </span>
<span id="cb913-25"><a href="sampling-bootstrapping.html#cb913-25"></a>  }</span>
<span id="cb913-26"><a href="sampling-bootstrapping.html#cb913-26"></a></span>
<span id="cb913-27"><a href="sampling-bootstrapping.html#cb913-27"></a></span>
<span id="cb913-28"><a href="sampling-bootstrapping.html#cb913-28"></a><span class="kw">map</span>(</span>
<span id="cb913-29"><a href="sampling-bootstrapping.html#cb913-29"></a>  <span class="dt">.x =</span> samples,</span>
<span id="cb913-30"><a href="sampling-bootstrapping.html#cb913-30"></a>  <span class="dt">.f =</span> plot_bootstrap,</span>
<span id="cb913-31"><a href="sampling-bootstrapping.html#cb913-31"></a>  <span class="dt">mu =</span> <span class="kw">mean</span>(population<span class="op">$</span>value)</span>
<span id="cb913-32"><a href="sampling-bootstrapping.html#cb913-32"></a>)</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre><code>## 
## [[2]]</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-9-4.png" width="672" /></p>
<pre><code>## 
## [[4]]</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-9-5.png" width="672" /></p>
<pre><code>## 
## [[5]]</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-9-6.png" width="672" /></p>
<p>What we can conclude from the above graphs is that low sample numbers do not provide a good insight for the population mean, bigger samples approximate the population mean better and if we can study the complete population we get exactly the population mean, but usually we cannot sample the complete population. How do we know we took a good (large enough) sample?</p>
</div>
<div id="bootstrap-resampling" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> Bootstrap resampling</h2>
<p><em>This example was adapted after Resampling a sample distribution (<code>bootstrapping</code>) from “The Art of Statistics”, by Sr. David Spiegelhalter, 2019</em></p>
<p>For each set of samples we can calculate a sample statistic. In this example we take the mean, <span class="math inline">\(\overline{x}\)</span>, of each collection of samples. However, please note that the sample statistic could be any descriptive statistic, such as the median, the standard deviation or a proportion, among others.</p>
<p>Now we want to know how precise we have been able to estimate the mean for the different sample-sets that we took from the population. In order to determine how accurate our statistic (in this case the mean) is we can imagine taking repeated samples (let’s say 1000) from the population, we could determine how much the calculated mean would vary, each time we take a sample. If we know how much these estimates vary we would know how precise they are. But only if we know the details of the population (this we usually do not know in real data).</p>
<p>One way to resolve this is to assume that the sample looks like the population. Because in real live we usually cannot take many repeated new samples from the population, we take repeated new samples from our samples. The underlying assumption is that we took care of randomization procedures for sample-taking</p>
<p>Suppose we draw a series of samples from our 100 samples we collected earlier. We randomly pick 1 sample, record its value, put it back in the population and draw another sample. We repeat this procedure 50 times. This is called a <code>boot</code>. A bootstrapping experiments usually consists of 1000 boots. Meaning that we draw 1000 samples of 50, with replacement (meaning that we put the sample back, before drawing a new sample)</p>
<p>Here we see 10 boots of a small bootsrapping experiment:</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="sampling-bootstrapping.html#cb924-1"></a><span class="kw">source</span>(</span>
<span id="cb924-2"><a href="sampling-bootstrapping.html#cb924-2"></a>  here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;these_boots_are_made_for.R&quot;</span>))</span>
<span id="cb924-3"><a href="sampling-bootstrapping.html#cb924-3"></a></span>
<span id="cb924-4"><a href="sampling-bootstrapping.html#cb924-4"></a><span class="kw">bootstrap</span>(<span class="dt">x =</span> population<span class="op">$</span>value,</span>
<span id="cb924-5"><a href="sampling-bootstrapping.html#cb924-5"></a>          <span class="dt">n =</span> <span class="dv">50</span>,</span>
<span id="cb924-6"><a href="sampling-bootstrapping.html#cb924-6"></a>          <span class="dt">iter =</span> <span class="dv">10</span>,</span>
<span id="cb924-7"><a href="sampling-bootstrapping.html#cb924-7"></a>          <span class="dt">as_tbl =</span> <span class="ot">TRUE</span>,</span>
<span id="cb924-8"><a href="sampling-bootstrapping.html#cb924-8"></a>          <span class="dt">mode =</span> <span class="st">&quot;raw&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb924-9"><a href="sampling-bootstrapping.html#cb924-9"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(</span>
<span id="cb924-10"><a href="sampling-bootstrapping.html#cb924-10"></a>    <span class="dt">cols =</span> <span class="kw">c</span>(V1<span class="op">:</span>V10), <span class="dt">names_to =</span> <span class="st">&quot;boot&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span> </span>
<span id="cb924-11"><a href="sampling-bootstrapping.html#cb924-11"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb924-12"><a href="sampling-bootstrapping.html#cb924-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">times =</span> <span class="dv">50</span>)) -&gt;<span class="st"> </span>boots_<span class="dv">50</span> </span></code></pre></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="sampling-bootstrapping.html#cb926-1"></a>boots_<span class="dv">50</span> <span class="op">%&gt;%</span></span>
<span id="cb926-2"><a href="sampling-bootstrapping.html#cb926-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb926-3"><a href="sampling-bootstrapping.html#cb926-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb926-4"><a href="sampling-bootstrapping.html#cb926-4"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>iter, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb926-5"><a href="sampling-bootstrapping.html#cb926-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Sampled values (n=50) of the 10 boots&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We now run a full bootstrapping experiment, with a number of different sample sizes (no_samples) and 1000 iterations (boots). In this experiment we will calculate the sample mean (<span class="math inline">\(\overline{x}\)</span>) for each bootstrapped sample. Below we run the experiment by using the function defined in “./R/these_boots_are_made_for.R”</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="sampling-bootstrapping.html#cb928-1"></a><span class="kw">source</span>(</span>
<span id="cb928-2"><a href="sampling-bootstrapping.html#cb928-2"></a>  here<span class="op">::</span><span class="kw">here</span>(</span>
<span id="cb928-3"><a href="sampling-bootstrapping.html#cb928-3"></a>    <span class="st">&quot;R&quot;</span>,</span>
<span id="cb928-4"><a href="sampling-bootstrapping.html#cb928-4"></a>    <span class="st">&quot;these_boots_are_made_for.R&quot;</span></span>
<span id="cb928-5"><a href="sampling-bootstrapping.html#cb928-5"></a>  )</span>
<span id="cb928-6"><a href="sampling-bootstrapping.html#cb928-6"></a>)</span>
<span id="cb928-7"><a href="sampling-bootstrapping.html#cb928-7"></a></span>
<span id="cb928-8"><a href="sampling-bootstrapping.html#cb928-8"></a><span class="co">## run my self-written bootstrap function, this function takes a number of arguments to tune your bootstraps, you can get mean, median sd or raw (the actual sampled values) for  bootstrap</span></span>
<span id="cb928-9"><a href="sampling-bootstrapping.html#cb928-9"></a><span class="co">## look at the source code here: &quot;.R/these_boots_are_made_for.R&quot;</span></span>
<span id="cb928-10"><a href="sampling-bootstrapping.html#cb928-10"></a><span class="co">## we use map to loop over the predifined list of bootstrap iterations (repeats of sampling 30 samples from our simulated population) </span></span>
<span id="cb928-11"><a href="sampling-bootstrapping.html#cb928-11"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb928-12"><a href="sampling-bootstrapping.html#cb928-12"></a></span>
<span id="cb928-13"><a href="sampling-bootstrapping.html#cb928-13"></a></span>
<span id="cb928-14"><a href="sampling-bootstrapping.html#cb928-14"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">map_df</span>(</span>
<span id="cb928-15"><a href="sampling-bootstrapping.html#cb928-15"></a>  <span class="dt">.x =</span> no_samples, <span class="co">## we use map to loop over the different sample sizes</span></span>
<span id="cb928-16"><a href="sampling-bootstrapping.html#cb928-16"></a>  <span class="dt">.f =</span> bootstrap,</span>
<span id="cb928-17"><a href="sampling-bootstrapping.html#cb928-17"></a>  <span class="dt">x =</span> population<span class="op">$</span>value,</span>
<span id="cb928-18"><a href="sampling-bootstrapping.html#cb928-18"></a>  <span class="dt">iter =</span> <span class="dv">1000</span>, <span class="co">## usually we run 1000 bootstraps </span></span>
<span id="cb928-19"><a href="sampling-bootstrapping.html#cb928-19"></a>  <span class="dt">mode =</span> <span class="st">&quot;mean&quot;</span>, <span class="co">## the resampling statistic to be calculated after the bootstrapping</span></span>
<span id="cb928-20"><a href="sampling-bootstrapping.html#cb928-20"></a>  <span class="dt">as_tbl =</span> <span class="ot">TRUE</span></span>
<span id="cb928-21"><a href="sampling-bootstrapping.html#cb928-21"></a>)</span>
<span id="cb928-22"><a href="sampling-bootstrapping.html#cb928-22"></a></span>
<span id="cb928-23"><a href="sampling-bootstrapping.html#cb928-23"></a>bootstraps_df &lt;-<span class="st"> </span>bootstraps <span class="op">%&gt;%</span></span>
<span id="cb928-24"><a href="sampling-bootstrapping.html#cb928-24"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_size =</span> <span class="kw">rep</span>(no_samples, <span class="dt">each =</span> <span class="dv">1000</span>))</span></code></pre></div>
<p>Let’s plot each bootstrap in a seperate graph.</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="sampling-bootstrapping.html#cb929-1"></a>mu &lt;-<span class="st"> </span><span class="kw">mean</span>(population<span class="op">$</span>value)</span>
<span id="cb929-2"><a href="sampling-bootstrapping.html#cb929-2"></a><span class="co">## in one plot</span></span>
<span id="cb929-3"><a href="sampling-bootstrapping.html#cb929-3"></a>bootstraps_df <span class="op">%&gt;%</span></span>
<span id="cb929-4"><a href="sampling-bootstrapping.html#cb929-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb929-5"><a href="sampling-bootstrapping.html#cb929-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">100</span>) <span class="op">+</span></span>
<span id="cb929-6"><a href="sampling-bootstrapping.html#cb929-6"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>sample_size, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb929-7"><a href="sampling-bootstrapping.html#cb929-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Sampled values bootstrapping experiment&quot;</span>) <span class="op">+</span></span>
<span id="cb929-8"><a href="sampling-bootstrapping.html#cb929-8"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mu, </span>
<span id="cb929-9"><a href="sampling-bootstrapping.html#cb929-9"></a>               <span class="dt">size =</span> <span class="fl">0.5</span>, </span>
<span id="cb929-10"><a href="sampling-bootstrapping.html#cb929-10"></a>               <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb929-11"><a href="sampling-bootstrapping.html#cb929-11"></a>               <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="ch12-probdistributions_sampling_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We see that the estimate for the mean of the sample distribution becomes more centered around the population mean mu (here we know it because we assumed the population to be the integers 1:5961). Usually the population mean is unknown and we use sampling to get an estimate for it. What we also can see from the graphs is that the variability in the original sample distribution is almost gone in the resampled bootstrap distribution of the means. It is most apparent if you compare the histograms to the earlier dot plots. Now we can estimate the precision of the estimated mean in the bootstrapped sample distribution, providing us with an idea on how precise a specific size of samples from a population represents the estimate for the mean.</p>
<p>To provide a number to this precision we can calculate the 95% confidence interval of the bootstrapped estimation for the sample mean. We also call this the <code>estimation of the margin of error</code></p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="sampling-bootstrapping.html#cb930-1"></a><span class="co"># install.packages(&quot;Rmisc&quot;)</span></span>
<span id="cb930-2"><a href="sampling-bootstrapping.html#cb930-2"></a><span class="kw">library</span>(Rmisc)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: plyr</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="sampling-bootstrapping.html#cb939-1"></a>bootstraps_list &lt;-<span class="st"> </span><span class="kw">map</span>(</span>
<span id="cb939-2"><a href="sampling-bootstrapping.html#cb939-2"></a>  <span class="dt">.x =</span> no_samples, <span class="co">## we use map to loop over the different sample sizes</span></span>
<span id="cb939-3"><a href="sampling-bootstrapping.html#cb939-3"></a>  <span class="dt">.f =</span> bootstrap,</span>
<span id="cb939-4"><a href="sampling-bootstrapping.html#cb939-4"></a>  <span class="dt">x =</span> population<span class="op">$</span>value,</span>
<span id="cb939-5"><a href="sampling-bootstrapping.html#cb939-5"></a>  <span class="dt">iter =</span> <span class="dv">1000</span>, <span class="co">## usually we run 1000 bootstraps </span></span>
<span id="cb939-6"><a href="sampling-bootstrapping.html#cb939-6"></a>  <span class="dt">mode =</span> <span class="st">&quot;mean&quot;</span>, <span class="co">## the resampling statistic to be calculated after the bootstrapping</span></span>
<span id="cb939-7"><a href="sampling-bootstrapping.html#cb939-7"></a>  <span class="dt">as_tbl =</span> <span class="ot">FALSE</span></span>
<span id="cb939-8"><a href="sampling-bootstrapping.html#cb939-8"></a>)</span>
<span id="cb939-9"><a href="sampling-bootstrapping.html#cb939-9"></a></span>
<span id="cb939-10"><a href="sampling-bootstrapping.html#cb939-10"></a></span>
<span id="cb939-11"><a href="sampling-bootstrapping.html#cb939-11"></a>margins_of_error &lt;-<span class="st"> </span><span class="kw">map_df</span>(</span>
<span id="cb939-12"><a href="sampling-bootstrapping.html#cb939-12"></a>  <span class="dt">.x =</span> bootstraps_list,</span>
<span id="cb939-13"><a href="sampling-bootstrapping.html#cb939-13"></a>  <span class="dt">.f =</span> CI</span>
<span id="cb939-14"><a href="sampling-bootstrapping.html#cb939-14"></a>) <span class="op">%&gt;%</span></span>
<span id="cb939-15"><a href="sampling-bootstrapping.html#cb939-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_size =</span> no_samples) <span class="op">%&gt;%</span></span>
<span id="cb939-16"><a href="sampling-bootstrapping.html#cb939-16"></a><span class="st">  </span><span class="kw">select</span>(</span>
<span id="cb939-17"><a href="sampling-bootstrapping.html#cb939-17"></a>    sample_size,</span>
<span id="cb939-18"><a href="sampling-bootstrapping.html#cb939-18"></a>    lower,</span>
<span id="cb939-19"><a href="sampling-bootstrapping.html#cb939-19"></a>    mean,</span>
<span id="cb939-20"><a href="sampling-bootstrapping.html#cb939-20"></a>    upper</span>
<span id="cb939-21"><a href="sampling-bootstrapping.html#cb939-21"></a>  )</span>
<span id="cb939-22"><a href="sampling-bootstrapping.html#cb939-22"></a></span>
<span id="cb939-23"><a href="sampling-bootstrapping.html#cb939-23"></a>margins_of_error</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   sample_size lower  mean upper
##         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1           5  24.0  24.2  24.4
## 2          10  23.8  24.0  24.1
## 3         100  24.0  24.0  24.1
## 4         500  24.0  24.0  24.1
## 5        5961  24.0  24.0  24.0</code></pre>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="sampling-bootstrapping.html#cb941-1"></a><span class="co">## Of course we can put them in a plot</span></span>
<span id="cb941-2"><a href="sampling-bootstrapping.html#cb941-2"></a><span class="co">#margins_of_error %&gt;%</span></span>
<span id="cb941-3"><a href="sampling-bootstrapping.html#cb941-3"></a><span class="co">#  ggplot(aes(x = mean)) </span></span></code></pre></div>
<p>OBVIOUSLY, If we bootstrap the whole population, we exactly get the population mean. Because we cannot sample the complete population in most cases, this is for demonstration purposes and derivative proof that bootstrapping is generally a good idea.</p>
<p>DOWNSIDE, The downside of bootstrapping is that it can be computationally expesive when we run many iterations over very large sample sizes.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="assumptions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uashogeschoolutrecht/staRters/edit/master/ch12-probdistributions_sampling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["exploratory_data_analysis.pdf", "exploratory_data_analysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
